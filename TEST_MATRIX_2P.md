# テストマトリクス（2人参加）

対象：
- プレイヤーA：ホスト
- プレイヤーB：非ホスト
- 形式：ノーリミット・テキサスホールデム
- 目的：UI挙動と内部状態の不整合を洗い出す

---

## 0. 事前条件
- 両者が同一ルームに参加済み
- Seatがそれぞれ1つずつ割り当てられている
- BB / 初期チップ設定が完了している

---

## 1. 待機〜開始フェーズ

### 1-1 ルーム参加
| 項目 | 内容 |
|---|---|
| 操作 | Aがルーム作成 → Bがコード入力で参加 |
| 期待UI | 両者とも待機画面に遷移 |
| 期待状態 | participants = 2 |

---

### 1-2 待機場からの離脱 → 再参加
| 操作 | Bが一度戻る → 再度コード入力 |
| 期待UI | 正常に待機場へ復帰 |
| NG | 入れなくなる／無反応 |

---

### 1-3 READY状態
| 操作 | BがREADY |
| 期待UI | A側にREADY反映 |
| 期待状態 | B.isReady = true |

---

### 1-4 ゲーム開始
| 操作 | Aが「確定して開始」 |
| 期待UI | 両者ともプレイ画面へ |
| 権限 | Bは開始不可 |

---

## 2. プリフロップ

### 2-1 最初のターン表示
| 観点 | 確認内容 |
|---|---|
| ターン表示 | 「◯◯のターン」が正しい |
| ボタン | ターンプレイヤーのみ表示 |
| 非ターン | 待ちUIのみ表示 |

---

### 2-2 コール
| 操作 | ターン側がCALL |
| 期待UI | 即ボタン消失 |
| 相手 | 待ち → 自分のターンへ |

---

### 2-3 レイズ（ミニマム）
| 操作 | RAISE（minRaiseTo） |
| 期待 | 正常に反映 |
| 表示 | To Call / Pot 更新 |

---

### 2-4 レイズ（ミニマム未満・非オールイン）
| 操作 | min未満で入力 |
| 期待 | エラー or 無効化 |
| NG | 実行できてしまう |

---

### 2-5 オールイン（ミニマム未満）
| 操作 | オールインでmin未満 |
| 期待 | レイズ扱いしない |
| 相手 | 再レイズ不可（CALL/FOLDのみ） |

---

## 3. フロップ / ターン / リバー

### 3-1 フェーズ遷移
| 確認 | 内容 |
|---|---|
| カード表示 | 0→3→4→5 |
| 表示 | 現在フェーズが分かる |
| 操作 | フェーズ間で操作不可時間なし |

---

### 3-2 待ち状態
| 観点 | 内容 |
|---|---|
| 非ターン | ボタン非表示 |
| 文言 | 「あなたの番になるまでお待ちください」 |
| 不安 | 固まった感がない |

---

## 4. フォールド終了

### 4-1 フォールド即終了
| 操作 | Bがフォールド |
| 期待 | 即ハンド終了 |
| 勝者 | A |
| UI | 結果画面へ |

---

## 5. ショーダウン

### 5-1 勝者選択権限
| 観点 | 内容 |
|---|---|
| ホスト | 勝者選択UIあり |
| 非ホスト | 待ち画面のみ |
| NG | 非ホストが触れる |

---

### 5-2 チョップ表示条件
| 条件 | 期待 |
|---|---|
| 両者残存 | チョップ表示 |
| 片方フォールド | チョップ非表示 |

---

### 5-3 結果確定
| 操作 | Aが確定 |
| 期待 | チップ分配 |
| 両者 | 同時に次画面 |

---

## 6. 次のハンド

### 6-1 自動遷移
| 操作 | Aが「次のハンド」 |
| 期待 | Bも自動遷移 |
| NG | Bが手動操作必要 |

---

## 7. 表示切替

### 7-1 BB / チップ切替
| 操作 | 表示切替 |
| 期待 | 表示のみ変化 |
| 内部 | 計算はチップ固定 |

---

## 8. バグ系チェック

### 8-1 二重アクション
| 条件 | 結果 |
|---|---|
| 連打 | 1回のみ有効 |
| 再表示 | 起きない |

---

### 8-2 通信遅延想定
| 条件 | 結果 |
|---|---|
| 遅延 | UI破綻なし |
| 状態 | ターンずれなし |

### RENDER-01 オフライン開始の描画
| 条件 | 結果 |
|---|---|
| オフライン開始 | Consoleエラーなし |
| プレイ画面 | アクションボタンが表示・クリック可 |

### ENV-01 file:// ガード
| 条件 | 結果 |
|---|---|
| file:// 起動 | 警告バナー表示 |
| SW | 登録を試みない |

### LAYOUT-01 座席配置安定性（2/3/4人）
| 条件 | 結果 |
|---|---|
| 2人 | モバイル/デスクトップで安定配置・テーブル内 |
| 3人 | モバイル/デスクトップで安定配置・テーブル内 |
| 4人 | モバイル/デスクトップで安定配置・テーブル内 |

### HOME-CLICK-01 ホーム画面クリック
| 条件 | 結果 |
|---|---|
| ルーム作成/参加/オフライン | クリック・タップが反応 |

---

### MODE-01 Online→Offline→Online→Offline
| 操作 | 期待 |
|---|---|
| オンライン参加 → 離脱 → オフライン開始 | アクションパネル表示・待機ロックなし |
| オフライン開始 → 離脱 → オンライン参加 → 離脱 → オフライン開始 | roomChannelが解放・appMode=offline・アクション表示 |

---

## 9. 完了条件
- 全項目で「期待どおり」
- NGがあれば Issue 化 → 再テスト
