# 進捗

## 現在のバージョン
- v0.8.0 (2026-02-02)

## 優先度基準
- P0: 進行を止める/重大不具合/最優先の体験改善
- P1: 重要な体験改善/近いうちに対応したい
- P2: 余裕があれば対応したい改善/演出

## ✅ 完了
- テーブル中央の画像（カードバックの透かし）を追加
- バージョン表示を画面右上に追加
- フェーズ表示のコミュニティカードは常に5枠表示（0→3→4→5でimg/trump.pngを表示）
- コミュニティカード画像の表示調整（cover）と透かし除去
- プレイヤーのアイコン選択を追加（セットアップ画面）
- プレイヤー情報の視認性を向上（ピル表示/強弱の調整）
- フェーズ表示の見た目調整（アクティブ強調）
- 設定画面のスクロール改善（上部の見切れ防止）
- スマホ幅でのレイアウト崩れ修正（アイコン列の横スクロール化）
- P0: モバイルのルームコード入力（iOSで入力/削除が不安定）
- ✅ ホストのREADY不要（座席選択で暗黙READY）
- ✅ 待機画面に戻るボタン追加
- ✅ チョップ表示の条件修正（フォールド除外・2人以上のみ）
- ✅ プレイヤー別の初期スタック設定
- ✅ 戻るボタンをヘッダーに配置（セーフエリア対応）
- ✅ 再入室時のゴーストセッション対策
- ✅ 表示切替（BB / チップ）
- ✅ ベットチップ表示を中央寄りに移動
- ✅ アクションボタンのタッチ性/階層を改善
- ✅ メニュー項目を横書きに修正＆表記切替追加
- ✅ 次のハンドを全員同期
- ✅ ランダム表示名を短縮（Animal+2桁）
- ✅ 最小レイズルールを実装（前回レイズサイズ基準）
- ✅ ホストの連続アクションを防止
- ✅ “Continue / Next Hand”を削除（CTA一本化）
- ✅ 設定画面で初期チップのBB換算表示
- ✅ アクションボタン表示の権限修正（自分のターンのみ）
- ✅ 待機状態表示の明確化（◯◯のターン / お待ちください）
- ✅ 結果登録はホストのみ（非ホストは待機表示）
- ✅ 画面遷移時のスクロールジャンプ問題を修正
- ✅ オフラインモードでのショーダウン表示を修正
- ✅ プレイヤー別チップ設定のUI改善（チップ入力→BB表示）
- ✅ 勝利ポップアップにアバター+名前を表示
- ✅ チップ状況ボタンと全体チップ状況表示を追加
- ✅ ハンド履歴機能を追加（メニューから表示）
- ✅ 設定画面に戻るボタンを追加
- ✅ スマホ用タイトルサイズ調整
- ✅ プレイヤー別チップ設定時に初期チップフォームを非表示
- ✅ プレイ画面の枠問題を修正（padding: 0）
- ✅ 切断時の警告ダイアログを追加（待つ/終了の選択肢）
- ✅ プレイ画面の背景画像を追加
- ✅ SB/BB変更時にプレイヤー別チップのBB数をリアルタイム更新
- ✅ ショーダウンで画面がフリーズする問題を解消（overlay / state遷移）
- ✅ チョップ表示のロジック修正（フォールド済みプレイヤー除外）
- ✅ ステータスバー追加（Pot / To Call / Min Raise 常時表示）
- ✅ アクティブプレイヤーの発光・ズーム効果を強化
- ✅ オールイン確認ダイアログを追加
- ✅ 接続状態インジケーターを追加（ヘッダー）
- ✅ ショーダウンUIの改善（キャンセル・確定ボタンを大きく）
- ✅ コードベース分割（index.html → css/style.css + js/game-logic.js + js/app.js）

## 🛠 進行中
- （進行中なし）

## 🧭 次の予定
- P0: プレイヤー名の可読性改善（最大幅拡張 or 2行化 or 縦レイアウト）
- P1: 「今誰の番か」の視認性強化（アクティブ名を上部バーに表示／テーブル上の強調）
- P1: 情報の優先度調整（バージョンはメニュー内へ、接続状態インジケーターを上部へ）
- P1: アクション/操作（参加・退出・離席など）ごとに分かりやすい効果音を用意
- P1: 途中参加の導線改善（メニューではなくテーブルの空席タップで参加予約）
- P2: プリフロップ時のコミュニティカード枠を非表示/最小化
- P2: ベットバッジ位置の統一（アバター内側・ポット方向）
- P2: ディーラーバッジの視認性改善（デザイン変更）
- P2: 待機メッセージの強調（スタイル強化）
- P2: 待機中画面のアニメーション追加（操作待ちの退屈さ軽減）
- P2: 操作待ち（ホスト操作待ち/非ターン待ち等）はボタン表現ではなく、アニメーションと「待ち状態」表現に統一
- P2: 操作待ちUIの詳細化（対象状態/文言/配置/アニメーション）
- P2: テーブルとプレイヤーカードのスケール調整（プレイヤー大きめ／テーブル小さめ）
- P1: ゲーム中の状態表示の改善（フェーズ / ポット / to-call / ターン）
- P1: ホストではREADYボタンを非表示にする
- P1: 戻るボタンの追加（フローを分かりやすく）
- P1: 結果登録画面の追加
- P1: プレイヤーごとの初期チップ設定（例: 200BBなど）
- P2: カード見た目のアップグレード（保留）
- P2: レイズUIの再設計（プリセット＋調整）（保留）
- P1: 「今だれの番？」を迷わせないUI（アクティブ席の発光＋軽いズーム／上部に「◯◯の番です」）
- P1: 「To Call」と「Pot」を常時表示のステータスバーに集約（Pot / Current bet / To Call / 最小レイズ）
- P1: ミス防止UI（3秒以内Undo／All-in確認ダイアログ／Raiseは確定ボタンで送信）
- P1: レイズUX（プリセット: 2.5BB/3BB/30%/50%/Pot＋調整ボタン／入力欄は詳細へ）
- P1: 手動チップ管理の救済（ホストのチップ修正＋履歴＋修正モードは隠す）
- P1: 同期体験の安定化（再同期ボタン／ホストのフェーズ遷移の確実反映）
- P2: 卓の演出（フェーズ移行アニメ／勝者へポット移動演出／ボイス）

## ⚠️ 既知の問題 / リスク
- P0: 途中参加が成立しない（「観戦から参加へ」を押しても観戦のまま）
- P1: iOS Safariでキーボードと固定レイヤーが干渉し、フォーカスが壊れることがある
- P1: オーバーレイの重なりでタップがブロックされる可能性

## 🔎 クイック確認リスト
- [ ] プレイ画面に中央ロゴが表示され、タップを妨げない
- [ ] バージョン表示が右上に出ている
- [ ] card-back.png が無い場合でもコンソールエラーが出ない
- [ ] プリフロップで5つの空スロットが表示される
- [ ] フロップ/ターン/リバーで3/4/5枚が表示される
- [ ] 設定画面が縦スクロールでき、上部が見切れない
- [ ] スマホ幅でアイコン列が横スクロールできる
- [ ] 待機画面でホストはREADYが表示されない
- [ ] ホストは座席選択後、参加者がREADYになると「設定へ進む」が有効
- [ ] 参加者は座席選択→READYの順で準備できる
- [ ] 待機画面の戻るボタンでルーム退出できる
- [ ] ショーダウンでチョップは有効プレイヤー2人以上のみ表示
- [ ] フォールド済みプレイヤーは勝者/チョップに選べない
- [ ] 初期チップをプレイヤー別BBで設定でき、BB×ビッグブラインドで反映される
- [ ] 戻るボタンが上部ヘッダー内にあり、セーフエリアを侵害しない
- [ ] 戻るでpresence解除され、同じルームコードに再入室できる
- [ ] 表示切替でBB/チップが切り替わる（内部計算はチップのまま）
- [ ] ベットチップがアバター下ではなくポット方向に寄る
- [ ] アクションボタンが押しやすくなり、FOLDが強すぎない
- [ ] メニューが縦書きにならず横書きで表示される
- [ ] 次のハンドを押すと全端末が同時に進む
- [ ] ランダム名が短い形式（例: Fox72）で生成される
- [ ] 最小レイズ未満は弾かれ、Min Raiseが表示される
- [ ] オールインの最小レイズ未満は許可され、アクションが再オープンしない
- [ ] 同一ターンでのホスト連続アクションが発生しない
- [ ] “Continue / Next Hand”が表示されない
- [ ] 初期チップのBB換算がリアルタイムで更新される
- [ ] 自分のターン以外はアクションボタンが表示されない
- [ ] 非ターン時は「◯◯のターンです」「お待ちください」が表示される
- [ ] ショーダウンの結果登録はホストのみ操作できる
- [ ] ステータスバーにPot / To Call / Min Raiseが常時表示される
- [ ] アクティブプレイヤーが発光・ズームで強調される
- [ ] オールイン時に確認ダイアログが表示される
- [ ] 接続状態がヘッダーに表示される（接続中/再接続中/切断）
- [ ] ショーダウンにキャンセルボタンがある

## リリースノート
### v0.8.0
- コードベース分割リファクタリング
  - index.html: 5139行 → 411行（HTMLのみ）
  - css/style.css: 1900行（全CSS）
  - js/game-logic.js: 286行（純粋なゲームロジック16関数）
  - js/app.js: 2576行（UI・通信・イベント116関数）
- 開発効率の向上（ファイル検索、AIコンテキスト対応）

### v0.7.0
- ステータスバー追加（Pot / To Call / Min Raise 常時表示）
- アクティブプレイヤーの発光・ズーム効果を強化
- オールイン確認ダイアログを追加
- 接続状態インジケーターを追加（ヘッダー）
- ショーダウンUIの改善（キャンセル・確定ボタンを大きく）

### v0.6.0
- 画面遷移時のスクロールジャンプ問題を修正
- オフラインモードでのショーダウン表示を修正
- プレイヤー別チップ設定のUI改善（チップ入力→BB表示）
- 勝利ポップアップにアバター+名前を表示
- チップ状況ボタンと全体チップ状況表示を追加
- ハンド履歴機能を追加（メニューから表示）
- 設定画面に戻るボタンを追加
- 切断時の警告ダイアログを追加
- プレイ画面の背景画像を追加
- SB/BB変更時にプレイヤー別チップのBB数をリアルタイム更新

### v0.5.0
- 初期チップのBB換算表示を追加
- 自分のターン以外はアクションボタンを非表示
- 待機状態表示の明確化
- 結果登録をホストに限定

### v0.4.5
- ランダム表示名の短縮（Animal+2桁）
- 最小レイズルール実装（前回レイズサイズ基準、短いオールインは再オープンしない）
- ホスト連続アクション防止
- “Continue / Next Hand”削除

### v0.4.4
- 戻るボタンをヘッダー化してセーフエリア対応
- 再入室時のゴーストセッション対策（presence解除）
- 表記切替（BB/チップ）とメニュー表示修正
- ベットチップの位置調整
- アクションボタンのタッチ性と階層改善
- 次のハンドの全端末同期

### v0.4.3
- 待機画面のホストREADY不要化と戻るボタン追加
- チョップ表示条件の修正（フォールド除外・2人以上のみ）
- プレイヤー別初期チップ（BB指定）に対応

### v0.4.2
- プレイヤーのアイコン選択を追加（セットアップ画面）
- 設定画面のスクロール改善とスマホ幅のレイアウト修正
- フェーズ表示とプレイヤー情報の見た目を調整

### v0.4.1
- コミュニティカード画像の表示調整（cover）と透かし除去

### v0.4.0
- フェーズ表示のコミュニティカードは常に5枠表示（0→3→4→5でimg/trump.pngを表示）

### v0.3.0
- テーブル中央の画像（カードバックの透かし）を追加（img/trump.png）

### v0.2.0
- テーブル中央のロゴ（カードバック透かし）を追加
- 進捗管理用のPROGRESS.mdを追加
- デプロイ確認用のバージョン表示を追加

## 参考資料（ルール）
- https://oag.ca.gov/sites/all/files/agweb/pdfs/gambling/oceans-eleven.pdf
- https://www.pokerstars.com/help/articles/poker-rules-master/
