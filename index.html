<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ポーカーチップ管理アプリ｜Pocket Pot（インストール不要）</title>
<meta name="description" content="インストール不要で今すぐ使える。スマホがチップ代わりになる無料アプリ、オフラインでもOK。">
<meta name="keywords" content="ポーカー,チップ,管理,アプリ,無料,ホームゲーム,テキサスホールデム">
<link rel="canonical" href="https://pocket-pot.vercel.app/">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZH7W86ZQSP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('consent', 'default', { analytics_storage: 'denied' });
  gtag('config', 'G-ZH7W86ZQSP', { anonymize_ip: true, send_page_view: false });
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Pocket Pot",
  "description": "インストール不要で今すぐ使える。スマホがチップ代わりになる無料アプリ、オフラインでもOK。",
  "url": "https://pocket-pot.vercel.app/",
  "applicationCategory": "GameApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "JPY"
  },
  "browserRequirements": "Requires a modern web browser",
  "inLanguage": "ja"
}
</script>
<meta name="google-site-verification" content="RZl1QAvsCeFFjMYhoLKlDbq8G_zzCPCInfgafPMBPb8">

<!-- OGP -->
<meta property="og:title" content="ポーカーチップ管理アプリ｜Pocket Pot（インストール不要）">
<meta property="og:description" content="インストール不要で今すぐ使える。スマホがチップ代わりになる無料アプリ、オフラインでもOK。">
<meta property="og:image" content="https://pocket-pot.vercel.app/img/ogp.png">
<meta property="og:url" content="https://pocket-pot.vercel.app/">
<meta property="og:type" content="website">
<meta property="og:site_name" content="Pocket Pot">
<meta property="og:locale" content="ja_JP">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="ポーカーチップ管理アプリ｜Pocket Pot（インストール不要）">
<meta name="twitter:description" content="インストール不要で今すぐ使える。スマホがチップ代わりになる無料アプリ、オフラインでもOK。">
<meta name="twitter:image" content="https://pocket-pot.vercel.app/img/ogp.png">
<meta name="twitter:site" content="@poket_pot_poker">
<meta name="theme-color" content="#1a3328">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="manifest" href="manifest.json">
<link rel="icon" href="img/logo.png" type="image/png">
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&family=Playfair+Display:wght@400;600;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- ─── ROOM SCREEN ───────────────────────────── -->
<div id="room-screen" class="screen is-active">
  <div class="app-version" id="app-version"></div>
  <h1 class="sr-only">ポーカーチップ管理アプリ（無料・オフライン対応）</h1>
  <div class="brand-header">
    <img src="img/logo.png" alt="Pocket Pot ロゴ" class="brand-logo">
    <div class="brand-title">Pocket Pot</div>
  </div>
  <h2 class="intro-heading">スマホ1台で、みんなで遊べる。</h2>
  <p class="intro-copy">ホームゲームに最適なオフライン対応のチップ管理アプリ</p>
  <div class="setup-section">
    <div class="setup-label">オフラインで遊ぶ</div>
    <div class="room-panel">
      <button class="room-btn primary" id="resume-offline-btn" style="width:100%; display:none;">▶ 途中から再開</button>
      <button class="room-btn" id="room-local-btn" style="width:100%;">📱 新しく開始</button>
    </div>
  </div>

  <div class="setup-section">
    <div class="setup-label">オンラインで遊ぶ</div>
    <div class="room-panel coming-soon-panel">
      <div class="room-row" style="margin-bottom:8px;">
        <input type="text" id="display-name-input" class="room-input" placeholder="表示名（オンライン用）">
      </div>
      <div class="room-row">
        <button class="room-btn primary" id="room-host-btn" style="flex:1;">🎲 新しいルーム作成</button>
      </div>
      <div class="room-row" style="margin-top:4px;">
        <span class="room-meta-label">コード長</span>
        <select class="room-select" id="room-code-length">
          <option value="3">3文字</option>
          <option value="6">6文字</option>
        </select>
      </div>
      <div class="room-row" style="margin-top:8px;">
        <input type="text" id="room-code-input" class="room-input" placeholder="ルームコード" maxlength="6" style="text-align:center;">
        <button class="room-btn" id="room-join-btn">参加</button>
      </div>
      <div class="room-status" id="room-status"></div>
      <div class="coming-soon-overlay" aria-hidden="true">
        <div class="coming-soon-pill">Coming Soon...</div>
      </div>
    </div>
  </div>
  <div class="setup-section">
    <button class="room-btn" id="room-history-btn" style="width:100%;" disabled>🕘 過去の履歴（Coming Soon）</button>
  </div>
  <div class="share-actions" aria-label="SNSで共有">
    <button class="share-btn" id="share-native-btn" type="button">共有</button>
    <a class="share-btn" id="share-x-btn" target="_blank" rel="noopener" aria-label="Xで共有">
      <svg class="share-icon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M18.9 3H22l-7.2 8.2L23 21h-6.2l-4.9-5.9L6.8 21H3.6l7.7-8.7L1 3h6.4l4.4 5.2L18.9 3zm-1.1 16h1.7L7.1 5H5.2l12.6 14z"/>
      </svg>
      <span class="share-label">X</span>
    </a>
    <a class="share-btn" id="share-line-btn" target="_blank" rel="noopener" aria-label="LINEで共有">
      <svg class="share-icon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 3c-5 0-9 3.4-9 7.6 0 2.6 1.6 4.9 4.1 6.3l-.6 3.1 3.2-2.1c.8.2 1.6.3 2.4.3 5 0 9-3.4 9-7.6S17 3 12 3zM7.6 11.2h8.8v1.6H7.6v-1.6zM7.6 8.4h8.8V10H7.6V8.4z"/>
      </svg>
      <span class="share-label">LINE</span>
    </a>
  </div>
  <div class="legal-links">
    <button class="legal-link" data-legal="disclaimer">免責・賭博禁止</button>
    <span class="legal-sep">/</span>
    <button class="legal-link" data-legal="privacy">プライバシーポリシー</button>
    <span class="legal-sep">/</span>
    <button class="legal-link" data-legal="terms">利用規約</button>
  </div>
</div>

<!-- ─── WAITING SCREEN ────────────────────────── -->
<div id="waiting-screen" class="screen hidden">
  <div class="screen-header">
    <button class="room-btn back-btn" id="waiting-back-btn">← 戻る</button>
  </div>
  <div class="brand-header">
    <img src="img/logo.png" alt="Pocket Pot ロゴ" class="brand-logo" loading="lazy" decoding="async">
    <div class="brand-title">Pocket Pot</div>
  </div>
  <div class="setup-subtitle">参加者が揃うのを待っています</div>

  <div class="setup-section">
    <div class="setup-label">ルームコード</div>
    <div class="room-panel">
      <div class="room-row">
        <div class="room-code-display" id="room-code-display">—</div>
        <button class="room-btn" id="room-copy-btn">COPY</button>
      </div>
    </div>
  </div>

  <div class="setup-section">
    <div class="setup-label">参加者</div>
    <div class="room-panel">
      <div class="participant-list" id="participant-list"></div>
    </div>
  </div>

  <div class="setup-section">
    <div class="setup-label">ゲームを始める準備</div>
    <div class="room-panel">
      <div class="step-guide">
        <div class="step-item" id="step-seat">
          <span class="step-num">1</span>
          <span class="step-text">テーブルの空席をタップ</span>
        </div>
        <div class="step-item" id="step-ready">
          <span class="step-num">2</span>
          <span class="step-text">READYボタンを押す</span>
        </div>
      </div>
      <div class="seat-ring" id="seat-ring"></div>
      <div class="waiting-self-panel">
        <div class="room-status" id="seat-help-text">👆 まず空席をタップしてね</div>
        <button class="ready-btn" id="ready-toggle-btn" disabled>READY</button>
      </div>
    </div>
  </div>

  <div class="setup-section" id="waiting-host-controls" style="display:none;">
    <button class="start-btn" id="waiting-start-btn">設定へ進む</button>
    <div class="room-status" id="waiting-host-status">2人以上で開始できます</div>
  </div>

  <div class="setup-section" id="waiting-guest-controls">
    <div class="room-panel">
      <div class="room-status">ホストが開始するのを待っています</div>
      <button class="room-btn" id="room-leave-btn">退出</button>
    </div>
  </div>
</div>

<!-- ─── SETTINGS SCREEN ───────────────────────── -->
<div id="settings-screen" class="screen hidden">
  <div class="settings-fixed-header">
    <div class="screen-header">
      <button class="room-btn back-btn" id="settings-back-btn">← 戻る</button>
    </div>
    <div class="brand-header">
      <img src="img/logo.png" alt="Pocket Pot ロゴ" class="brand-logo" loading="lazy" decoding="async">
      <div class="brand-title">Pocket Pot</div>
    </div>
  </div>
  <div class="setup-subtitle">ゲーム設定</div>

  <div id="settings-host-panel">
    <div class="setup-section">
      <div class="setup-label">基本設定</div>
      <div class="blind-row">
        <div class="blind-input-wrap">
          <span class="blind-input-label">Small Blind</span>
          <input type="number" id="sb-input" value="10" min="1" inputmode="numeric" pattern="[0-9]*" enterkeyhint="done">
        </div>
        <div class="blind-input-wrap">
          <span class="blind-input-label">Big Blind</span>
          <input type="number" id="bb-input" value="20" min="1" inputmode="numeric" pattern="[0-9]*" enterkeyhint="done">
        </div>
      </div>
      <div class="blind-row" id="initial-chips-row" style="margin-top: 12px;">
        <div class="blind-input-wrap" style="flex: 1;">
          <span class="blind-input-label">初期チップ</span>
          <input type="number" id="initial-chips-input" value="1000" min="1" inputmode="numeric" pattern="[0-9]*" enterkeyhint="done">
          <div class="bb-hint" id="initial-chips-bb">初期チップ：1000（= 50 BB）</div>
        </div>
      </div>
    <div class="blind-row" style="margin-top: 12px;">
      <label class="toggle-label" style="width:100%;">
        <input type="checkbox" id="per-player-stack-toggle">
        <span class="toggle-text">プレイヤー別に初期チップを設定</span>
      </label>
    </div>
    <div class="per-player-stack-list" id="per-player-stack-list" style="display:none;"></div>
  </div>

    <div class="setup-section" id="online-player-summary" style="display:none;">
      <div class="setup-label">参加者</div>
      <div class="room-panel">
        <div class="participant-list" id="participant-summary"></div>
      </div>
    </div>

    <div class="setup-section" id="local-player-settings">
      <div class="setup-label">ローカル参加者</div>
      <div class="player-inputs" id="player-inputs">
        <div class="player-row">
          <div class="player-name-row">
            <input type="text" class="player-name-input" placeholder="プレイヤー名" value="プレイヤー１">
          </div>
          <div class="icon-picker"></div>
        </div>
        <div class="player-row">
          <div class="player-name-row">
            <input type="text" class="player-name-input" placeholder="プレイヤー名" value="プレイヤー２">
          </div>
          <div class="icon-picker"></div>
        </div>
      </div>
      <button class="add-player-btn" onclick="addPlayer()">＋ プレイヤー追加</button>
    </div>

    <details class="setup-section">
      <summary class="setup-label">詳細設定</summary>
      <div class="blind-row" style="margin-top: 12px;">
        <div class="blind-input-wrap">
          <span class="blind-input-label">アクションタイマー</span>
          <select id="timer-select">
            <option value="0" selected>無制限</option>
            <option value="15">15秒</option>
            <option value="30">30秒</option>
            <option value="60">60秒</option>
          </select>
        </div>
      </div>
      <label class="toggle-label" style="margin-top: 10px;">
        <input type="checkbox" id="timer-sound-toggle" checked>
        <span class="toggle-text">効果音</span>
      </label>
      <div class="tournament-config" id="tournament-config">
        <label class="toggle-label tournament-toggle">
          <input type="checkbox" id="tournament-mode-toggle">
          <span class="toggle-text">トーナメントモード</span>
        </label>
        <div class="tournament-options" id="tournament-options" style="display: none;">
          <div class="blind-row" style="margin-top: 12px;">
            <div class="blind-input-wrap" style="flex: 1;">
              <span class="blind-input-label">ブラインドレベル時間</span>
              <select id="blind-level-select">
                <option value="10">10分</option>
                <option value="15" selected>15分</option>
                <option value="20">20分</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <label class="toggle-label" style="margin-top: 10px;">
        <input type="checkbox" id="late-join-toggle" checked>
        <span class="toggle-text">途中参加を許可</span>
      </label>
      <div class="blind-row" style="margin-top: 8px;">
        <div class="blind-input-wrap" style="flex: 1;">
          <span class="blind-input-label">途中参加の最大スタック</span>
          <input type="number" id="late-join-max-chips" value="1000" min="1" inputmode="numeric" pattern="[0-9]*" enterkeyhint="done">
        </div>
      </div>
    </details>

    <button class="start-btn" id="start-btn">確定して開始</button>
  </div>

  <div id="settings-guest-panel" style="display:none;">
    <div class="setup-section">
      <div class="waiting-indicator">
        <div class="waiting-spinner"></div>
        <div class="waiting-text">ホストがゲーム設定中...</div>
        <div class="waiting-subtext">まもなくゲームが始まります</div>
      </div>
    </div>
    <div class="setup-section">
      <div class="room-panel">
        <div class="participant-list" id="guest-participant-summary"></div>
      </div>
    </div>
    <div class="setup-section">
      <button class="room-btn" id="settings-leave-btn" style="width:100%;">退出</button>
    </div>
  </div>
</div>

<!-- ─── GAME SCREEN ───────────────────────────── -->
<div id="game-screen" class="screen hidden">
  <div class="tournament-bar" id="tournament-bar" style="display: none;">
    <div class="level">Level 1</div>
    <div class="blinds">10 / 20</div>
    <div class="next-level">次のレベルまで: <span>15:00</span></div>
  </div>
  <div class="game-header">
    <div class="game-header-brand">
      <img src="img/logo.png" alt="Pocket Pot ロゴ" class="game-header-logo" loading="lazy" decoding="async">
      <span class="game-header-title">Pocket Pot</span>
      <span class="game-header-version"></span>
    </div>
    <div class="header-actions">
      <div class="player-badge" id="player-badge" style="display:none;">
        <span class="tag" id="player-role-tag">PLAYER</span>
        <span id="player-name-tag">—</span>
      </div>
      <div class="connection-indicator" id="connection-indicator" title="接続状態">
        <span class="connection-dot"></span>
        <span class="connection-text">接続中</span>
      </div>
      <button class="header-btn" id="menu-btn">⋯</button>
    </div>
  </div>

  <div class="phase-bar" id="phase-bar">
    <div class="phase-step active" data-phase="preflop">PRE</div>
    <div class="phase-step" data-phase="flop">FLOP</div>
    <div class="phase-step" data-phase="turn">TURN</div>
    <div class="phase-step" data-phase="river">RIVER</div>
  </div>

  <div class="join-status-banner" id="join-status-banner">
    <div class="join-status-left">
      <div class="join-status-badge">⏳</div>
      <div class="join-status-text">
        <div class="join-status-title" id="join-status-title">参加待機中</div>
        <div class="join-status-sub" id="join-status-sub">席を選ぶと次ハンドから参加</div>
        <div class="join-progress">
          <div class="join-progress-bar" id="join-progress-bar"></div>
        </div>
      </div>
    </div>
    <div class="join-status-actions">
      <button class="join-status-btn" id="rebuy-request-btn" style="display:none;">リバイ申請</button>
      <button class="join-status-btn" id="join-seat-btn">席を選ぶ</button>
      <button class="join-status-btn danger" id="join-cancel-btn">取り消し</button>
    </div>
  </div>

  <!-- Vertical lane structure: opponents → table → you -->
  <div class="game-layout">
    <!-- Opponents area (top) -->
    <div class="opponents-area" id="opponents-area"></div>

    <!-- Table area (middle) -->
    <div class="table-area">
      <div class="table-frame" id="table-frame">
        <img class="table-image" src="img/table-tate.png" alt="ポーカー卓のイメージ" loading="lazy" decoding="async">
      </div>
      <div class="player-slots" id="player-slots"></div>
      <div class="table-bets" id="table-bets"></div>
      <div class="community-cards" id="community-cards"></div>
      <!--
      <div class="pot-stack" id="pot-stack">
        <img class="pot-chip" src="img/stockchip.png" alt="ポットに集まるチップ" loading="lazy" decoding="async">
        <div class="pot-stack-amount" id="pot-stack-amount">0</div>
      </div>
      -->
      <div class="pot-center">
        <img class="pot-chip" src="img/stockchip.png" alt="ポットに集まるチップ" loading="lazy" decoding="async">
        <div class="pot-label">POT</div>
        <div class="pot-amount" id="pot-amount">0</div>
      </div>
      <div class="blinds-center" id="pot-blinds">Blinds: 0,0</div>
    </div>

    <!-- Local player area (bottom) -->
    <div class="local-player-area" id="local-player-area"></div>
  </div>

  <div class="status-bar" id="status-bar">
    <div class="status-item">
      <span class="status-label">TO CALL</span>
      <span class="status-value" id="status-to-call">0</span>
    </div>
    <div class="status-item">
      <span class="status-label">MIN RAISE</span>
      <span class="status-value" id="status-min-raise">0</span>
    </div>
  </div>

  <div class="action-panel" id="action-panel">
    <div class="action-lock-message" id="action-lock-message" style="display:none;">あなたの番になるまでお待ちください</div>
    <div class="action-aux" id="action-aux">
      <label class="aux-toggle">
        <input type="checkbox" id="away-toggle">
        <span class="aux-toggle-track"></span>
        <span class="aux-toggle-text">離席中</span>
      </label>
      <button class="aux-exit-btn" id="exit-next-hand-btn">次ハンドで退出</button>
    </div>
    <div class="action-btns" id="action-btns"></div>
    <div class="raise-presets-row" id="raise-presets-row">
      <div class="raise-presets" id="raise-presets"></div>
    </div>
    <div class="raise-area" id="raise-area">
      <div class="raise-error" id="raise-error" style="display:none;"></div>
      <div class="raise-slider-row">
        <div class="raise-amount" id="raise-amount-display">0</div>
        <input type="range" id="raise-slider" min="0" max="100" value="30" oninput="onRaiseSlide()">
      </div>
    </div>
  </div>
</div>

<!-- ─── SHOWDOWN OVERLAY ──────────────────────── -->
<div class="showdown-overlay" id="showdown-overlay">
  <div class="showdown-card">
    <div class="showdown-title">ショーダウン - 勝者を選択</div>
    <div class="showdown-pot" id="showdown-pot-amount">0</div>
    <div class="showdown-pot-label">TOTAL POT</div>
    <div class="showdown-pot-tabs" id="showdown-pot-tabs"></div>
    <div class="showdown-pot-target" id="showdown-pot-target"></div>
    <div class="winner-select" id="winner-select"></div>
    <div class="split-toggle">
      <span class="split-label">チョップ（引き分け）</span>
      <div class="toggle-switch" id="split-toggle" onclick="toggleSplit()"></div>
    </div>
    <div class="showdown-buttons">
      <button class="confirm-winner-btn" id="confirm-winner-btn" onclick="confirmWinner()" disabled>確定</button>
    </div>
  </div>
</div>

<!-- ─── NEXT HAND ─────────────────────────────── -->
<div class="next-hand-overlay" id="next-hand-overlay">
  <div class="next-hand-card">
    <div class="next-hand-winners" id="next-hand-winners"></div>
    <div class="next-hand-sub" id="next-hand-sub">の勝ち！</div>
    <div class="next-hand-round" id="next-hand-round"></div>
    <div class="next-hand-deal-help" id="next-hand-deal-help"></div>
    <div class="next-hand-gain" id="next-hand-gain"></div>
    <div class="next-hand-chip-status" id="next-hand-chip-status"></div>
    <!-- チップゼロプレイヤー用の選択UI -->
    <div class="zero-chip-section" id="zero-chip-section" style="display:none;">
      <div class="zero-chip-title">チップがなくなったプレイヤー</div>
      <div class="zero-chip-list" id="zero-chip-list"></div>
    </div>
    <!-- ハンド間の調整ボタン -->
    <div class="between-hand-actions" id="between-hand-actions">
      <button class="between-hand-btn" onclick="showChipAdjustFromNextHand()">チップ調整</button>
      <button class="between-hand-btn" onclick="showPlayerManageFromNextHand()">プレイヤー管理</button>
    </div>
    <button class="next-hand-btn" id="next-hand-btn" onclick="nextHand()">次のハンド</button>
  </div>
</div>

<!-- ─── ROUND GUIDE OVERLAY ───────────────────── -->
<div class="confirm-dialog-overlay" id="round-guide-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title" id="round-guide-title">Round開始</div>
    <div class="confirm-dialog-message compact" id="round-guide-message">SBからカードを配ってください。<br>準備できたら次のアクションへ進みます。</div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn primary" id="round-guide-ok-btn">OK</button>
    </div>
  </div>
</div>

<!-- ─── CHIP STATUS OVERLAY ───────────────────── -->
<div class="chip-status-overlay" id="chip-status-overlay">
  <div class="chip-status-card">
    <div class="chip-status-title">チップ状況</div>
    <div class="chip-status-table" id="chip-status-table"></div>
    <button class="next-hand-btn" onclick="hideChipStatus(); nextHand();">次のハンド</button>
  </div>
</div>

<!-- ─── HAND HISTORY OVERLAY ─────────────────── -->
<div class="chip-status-overlay" id="history-overlay">
  <div class="chip-status-card" style="max-width: 400px;">
    <div class="chip-status-title">ハンド履歴</div>
    <div class="history-filters">
      <div class="history-filter">
        <input type="number" id="history-filter-hand" placeholder="ハンド番号">
      </div>
      <div class="history-filter">
        <input type="text" id="history-filter-winner" placeholder="勝者名">
      </div>
      <div class="history-filter">
        <input type="number" id="history-filter-minpot" placeholder="最小ポット">
      </div>
      <div class="history-filter-actions">
        <button class="history-filter-btn" id="history-filter-clear">クリア</button>
      </div>
    </div>
    <div class="history-list" id="history-list"></div>
    <button class="next-hand-btn" onclick="hideHistory()">閉じる</button>
  </div>
</div>

<!-- ─── WIN FLASH ─────────────────────────────── -->
<div class="win-flash" id="win-flash"></div>

<div class="toast" id="toast"></div>

<!-- ─── RECONNECT / JOIN MODAL ───────────────── -->
<div class="confirm-dialog-overlay" id="reconnect-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title" id="reconnect-title">進行中のゲーム</div>
    <div class="confirm-dialog-message" id="reconnect-message">進行中のゲームが見つかりました。参加しますか？</div>
    <div class="reconnect-dialog-body">
      <div class="reconnect-row" id="reconnect-chip-row">
        <input class="reconnect-chip-input" id="reconnect-chips" type="number" min="1" step="1" inputmode="numeric" value="1000">
        <span class="reconnect-dialog-note">チップ（初期値）</span>
      </div>
      <div class="reconnect-dialog-note" id="reconnect-note">参加を選ぶと次のハンドから入れます。</div>
    </div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="reconnect-watch-btn">観戦する</button>
      <button class="confirm-dialog-btn primary" id="reconnect-play-btn">参加する</button>
    </div>
    <div class="confirm-dialog-buttons" style="margin-top:10px;">
      <button class="confirm-dialog-btn danger" id="reconnect-cancel-btn">キャンセル</button>
    </div>
  </div>
</div>

<!-- ─── SEAT SELECT MODAL ────────────────────── -->
<div class="confirm-dialog-overlay" id="seat-select-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">席を選択</div>
    <div class="confirm-dialog-message">空いている席を選んでください</div>
    <div class="seat-select-grid" id="seat-select-grid"></div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="seat-select-cancel-btn">キャンセル</button>
    </div>
  </div>
</div>

<!-- ─── JOIN CANCEL CONFIRM ──────────────────── -->
<div class="confirm-dialog-overlay" id="join-cancel-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">参加の取り消し</div>
    <div class="confirm-dialog-message">参加申請を取り消して観戦に戻りますか？</div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="join-cancel-no">キャンセル</button>
      <button class="confirm-dialog-btn danger" id="join-cancel-yes">取り消す</button>
    </div>
  </div>
</div>

<!-- ─── FOLD CONFIRM DIALOG ───────────────────── -->
<div class="confirm-dialog-overlay" id="fold-confirm-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">フォールドの確認</div>
    <div class="confirm-dialog-message">チェックできますが、本当にフォールドしますか？</div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="fold-cancel-btn">キャンセル</button>
      <button class="confirm-dialog-btn danger" id="fold-confirm-btn">フォールドする</button>
    </div>
  </div>
</div>

<!-- ─── ALL-IN CONFIRM DIALOG ─────────────────── -->
<div class="confirm-dialog-overlay" id="allin-confirm-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">オールインの確認</div>
    <div class="confirm-dialog-message" id="allin-confirm-message">すべてのチップを賭けます。本当にオールインしますか？</div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="allin-cancel-btn">キャンセル</button>
      <button class="confirm-dialog-btn danger" id="allin-confirm-btn">オールイン</button>
    </div>
  </div>
</div>

<!-- ─── DISCONNECT DIALOG ────────────────────── -->
<div class="confirm-dialog-overlay" id="disconnect-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">接続が切断されました</div>
    <div class="confirm-dialog-message">サーバーとの接続が失われました。再接続を待つか、ゲームを終了してください。</div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="disconnect-wait-btn">再接続を待つ</button>
      <button class="confirm-dialog-btn danger" id="disconnect-exit-btn">ゲームを終了</button>
    </div>
  </div>
</div>

<!-- ─── SCRIPT ────────────────────────────────── -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>
<script src="js/game-logic.js" defer></script>
<script src="js/app.js" defer></script>

<!-- Global Menu (outside screens for z-index) -->
<div id="header-menu" style="display:none; position:fixed; top:60px; right:20px; background:rgba(26,51,40,0.98); border:3px solid #d4af37; border-radius:12px; padding:12px; z-index:999999; min-width:200px; flex-direction:column; gap:8px; box-shadow: 0 10px 40px rgba(0,0,0,0.8);">
  <button class="header-menu-item" id="menu-join-btn" style="padding:12px; background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); border-radius:8px; color:#f0ece0; cursor:pointer; display:none;">観戦から参加へ</button>
  <button class="header-menu-item" id="menu-join-status" style="padding:12px; background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15); border-radius:8px; color:#f0ece0; cursor:default; display:none;" disabled>参加状態: 観戦</button>
  <button class="header-menu-item" id="menu-sound-toggle" style="padding:12px; background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); border-radius:8px; color:#f0ece0; cursor:pointer;">音量: ON</button>
  <button class="header-menu-item" id="menu-display-toggle" style="padding:12px; background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); border-radius:8px; color:#f0ece0; cursor:pointer;">表記切替: CHIP</button>
  <button class="header-menu-item" id="menu-history-btn" style="padding:12px; background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); border-radius:8px; color:#f0ece0; cursor:pointer;">履歴を表示</button>
  <button class="header-menu-item" id="menu-undo-action-btn" style="padding:12px; background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15); border-radius:8px; color:#f0ece0; cursor:pointer; display:none;">前のアクションに戻る</button>
  <button class="header-menu-item" id="menu-save-exit-btn" style="padding:12px; background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15); border-radius:8px; color:#f0ece0; cursor:pointer; display:none;">保存して終了</button>
  <button class="header-menu-item" id="menu-reset-btn" style="padding:12px; background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); border-radius:8px; color:#f0ece0; cursor:pointer;">結果を見る/共有する</button>
</div>

<!-- ─── ENDGAME OVERLAY ─────────────────────── -->
<div class="confirm-dialog-overlay" id="endgame-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">結果をシェアして締めよう</div>
    <div class="confirm-dialog-message compact endgame-summary" id="endgame-summary">—</div>
    <div class="endgame-ranking" id="endgame-ranking-list"></div>
    <div class="confirm-dialog-buttons" style="margin-bottom:10px;">
      <button class="confirm-dialog-btn primary endgame-share-btn endgame-share-x" id="endgame-share-x" aria-label="Xで共有">
        <svg class="endgame-share-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M18.9 3H22l-7.2 8.2L23 21h-6.2l-4.9-5.9L6.8 21H3.6l7.7-8.7L1 3h6.4l4.4 5.2L18.9 3zm-1.1 16h1.7L7.1 5H5.2l12.6 14z"/>
        </svg>
        <span>Xで共有</span>
      </button>
      <button class="confirm-dialog-btn primary endgame-share-btn endgame-share-line" id="endgame-share-line" aria-label="LINEで共有">
        <svg class="endgame-share-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 3c-5 0-9 3.4-9 7.6 0 2.6 1.6 4.9 4.1 6.3l-.6 3.1 3.2-2.1c.8.2 1.6.3 2.4.3 5 0 9-3.4 9-7.6S17 3 12 3zM7.6 11.2h8.8v1.6H7.6v-1.6zM7.6 8.4h8.8V10H7.6V8.4z"/>
        </svg>
        <span>LINEで共有</span>
      </button>
    </div>
    <div class="confirm-dialog-buttons" style="margin-bottom:10px;">
      <button class="confirm-dialog-btn" id="endgame-share-image">画像で共有</button>
      <button class="confirm-dialog-btn" id="endgame-edit-share">文面を編集</button>
    </div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="endgame-replay-btn">やっぱり続ける</button>
      <button class="confirm-dialog-btn danger" id="endgame-close-btn">ホームに戻る</button>
    </div>
  </div>
</div>

<!-- ─── SHARE TEMPLATE OVERLAY ────────────────── -->
<div class="confirm-dialog-overlay" id="share-template-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">共有文を編集</div>
    <div class="confirm-dialog-message compact">`{hands}` `{pot}` `{winner}` `{round}` `{url}` が使えます</div>
    <textarea id="share-template-input" class="share-template-input" rows="6"></textarea>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="share-template-reset-btn">初期化</button>
      <button class="confirm-dialog-btn cancel" id="share-template-cancel-btn">閉じる</button>
      <button class="confirm-dialog-btn primary" id="share-template-save-btn">保存</button>
    </div>
  </div>
</div>

<!-- ─── HOME HISTORY OVERLAY ───────────────────── -->
<div class="confirm-dialog-overlay" id="home-history-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">過去のゲーム履歴</div>
    <div class="home-history-list" id="home-history-list"></div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="home-history-close-btn">閉じる</button>
    </div>
  </div>
</div>

<!-- ─── UNDO ACTION OVERLAY ─────────────────── -->
<div class="confirm-dialog-overlay" id="undo-action-overlay">
  <div class="confirm-dialog">
    <div class="confirm-dialog-title">前のアクションに戻る</div>
    <div class="confirm-dialog-message">直前の操作を取り消して、1つ前の状態に戻します。</div>
    <div class="confirm-dialog-buttons">
      <button class="confirm-dialog-btn cancel" id="undo-action-cancel-btn">キャンセル</button>
      <button class="confirm-dialog-btn danger" id="undo-action-confirm-btn">戻る</button>
    </div>
  </div>
</div>

<!-- ─── CHIP ADJUST OVERLAY ─────────────────── -->
<div class="chip-status-overlay" id="chip-adjust-overlay">
  <div class="chip-status-card">
    <div class="chip-status-title">チップ調整</div>
    <div class="chip-adjust-list" id="chip-adjust-list"></div>
    <div class="chip-adjust-actions">
      <button class="showdown-cancel-btn" onclick="hideChipAdjust()">キャンセル</button>
      <button class="confirm-winner-btn" onclick="saveChipAdjust()">保存</button>
    </div>
  </div>
</div>

<!-- ─── PLAYER MANAGE OVERLAY ───────────────── -->
<div class="chip-status-overlay" id="player-manage-overlay">
  <div class="chip-status-card">
    <div class="chip-status-title">プレイヤー追加/退席</div>
    <div class="player-manage-form">
      <input type="text" id="player-manage-name" placeholder="プレイヤー名">
      <input type="number" id="player-manage-chips" placeholder="チップ">
      <button class="confirm-winner-btn" onclick="addPlayerFromMenu()">追加</button>
    </div>
    <div class="player-manage-list" id="player-manage-list"></div>
    <button class="showdown-cancel-btn" onclick="hidePlayerManage()">閉じる</button>
  </div>
</div>

<!-- ─── LEGAL OVERLAY ───────────────────────── -->
<div class="legal-overlay" id="legal-overlay">
  <div class="legal-card">
    <div class="legal-title" id="legal-title">—</div>
    <div class="legal-body" id="legal-body"></div>
    <div class="legal-actions">
      <button class="legal-close-btn" id="legal-close-btn">閉じる</button>
    </div>
  </div>
</div>

<!-- ─── LEGAL CONSENT OVERLAY ────────────────── -->
<div class="legal-consent-overlay" id="legal-consent-overlay">
  <div class="legal-card">
    <div class="legal-title">利用に関する重要なお知らせ</div>
    <div class="legal-body">
      <p>本アプリは友人間のポーカーにおけるチップ管理を目的とした娯楽ツールです。現金賭博や違法行為を助長・支援するものではありません。</p>
      <ul>
        <li>現金の賭博や違法行為の目的での使用を禁止します。</li>
        <li>18歳以上推奨（各地域の成人年齢以上）。未成年の利用は保護者の同意の下で行ってください。</li>
        <li>各国・地域の法令遵守は利用者の責任です。</li>
      </ul>
      <p>詳細は「免責・賭博禁止」をご確認ください。</p>
    </div>
    <div class="legal-actions">
      <button class="legal-accept-btn" id="legal-accept-btn">同意して続ける</button>
    </div>
  </div>
</div>

<!-- ─── UPDATE BANNER ───────────────────────────── -->
<div class="update-banner" id="update-banner" style="display:none;">
  <span>新しいバージョンがあります</span>
  <button class="update-btn" onclick="applyUpdate()">更新</button>
</div>
</body>
</html>
